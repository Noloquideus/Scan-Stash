import asyncio

from fastapi import FastAPI
from uvicorn import Server, Config

from hello.routes.auth import auth_router
from hello.routes.items import items_router
from hello.services.auth import AuthService


async def main() -> None:
    app = FastAPI()

    auth_service = AuthService()
    app.dependency_overrides[AuthService] = lambda: auth_service

    app.include_router(auth_router)
    app.include_router(items_router)

    config = Config(app)
    server = Server(config)

    await server.serve()


asyncio.run(main())
